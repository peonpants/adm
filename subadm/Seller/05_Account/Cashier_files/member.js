var TeG=TeG||{};TeG.MemberParent={List:{activate:function(){this.init()},_gridName:null,_printTitle:null,gridBehaivor:null,widgetLockUnlockUrl:null,widgetResetPasswordUrl:null,setPrintTitle:function(n){this._printTitle=n},getPrintTitle:function(){return this._printTitle},setGridName:function(n){this._gridName=n},getGridName:function(){return this._gridName},gridOnBound:function(){resizeGrid();this.gridBehaivor=new TeG.Grid($("#"+this.getGridName()).data("kendoGrid"));this.gridBehaivor.addColumnOrderBehaivor.call(this.gridBehaivor);this.gridBehaivor.onBound();this.gridBehaivor.addSearchBehaivor();this.gridBehaivor.uniqueColumnName="LoginName";$("#printAgentList").off();$("#printAgentList").on("click",{that:this},function(n){var t=new(TeG.Print().PrintGrid);console.log(t);t.setGrid($("#"+n.data.that.getGridName()).data("kendoGrid"));t.setTitle(n.data.that.getPrintTitle());t.store().open()});(this.memberType=="MasterAgent"||this.memberType=="HeadOffice")&&$("td.progressiveStatus").each(function(){switch(Number($(this).attr("name"))){case TeG.Enums.ProgressiveStatus.YES:case TeG.Enums.ProgressiveStatus.ThresholdAlerted:case TeG.Enums.ProgressiveStatus.ThresholdBlocked:$(this).attr("title",TeG.Translations.ToolTipMemberProgressiveStatusYes);break;case TeG.Enums.ProgressiveStatus.PendingForEnable:$(this).attr("title",TeG.Translations.ToolTipMemberProgressiveStatusPendingToAdd);break;case TeG.Enums.ProgressiveStatus.PendingForDisable:$(this).attr("title",TeG.Translations.ToolTipMemberProgressiveStatusPendingToRemove)}})},gridOnChange:function(){TeG.isMobile()||TeG.isIPad()},nestedContentLoad:function(){var u,t,i,f,n,r,e;$(".empty-table-part").width($("td.fake-column").outerWidth());$(".widgetLockUnlockMember span.lock").index()!=-1?$(".js-updateBalanceInput").focus():($(".widgetLockUnlockMember").focus(),$(".js-updateBalanceInput").attr("disabled","disabled"),$(".js-update-balance-btn").attr("disabled","disabled"));$("#updateBalanceBlock").hasClass("disabled")&&($("#updateBalanceBlock").find("input").attr("disabled","disabled"),$("#updateBalanceBlock").find("button").attr("disabled","disabled"),$("#updateBalanceBlock").find("select").attr("disabled","disabled"));u=this.gridBehaivor.getSelectedRowData().FirstName+" "+this.gridBehaivor.getSelectedRowData().LastName;$('.js-member-nested-block [name="deleteMemberErrorNotEmptyBalanceTitle"]').val($('.js-member-nested-block [name="deleteMemberErrorNotEmptyBalanceTitle"]').val()+" "+u);$('.js-member-nested-block [name="deleteMemberConfirmationBalancedTitle"]').val($('.js-member-nested-block [name="deleteMemberConfirmationBalancedTitle"]').val()+" "+u);$('.js-member-nested-block [name="deleteMemberErrorTitle"]').val($('.js-member-nested-block [name="deleteMemberErrorTitle"]').val()+" "+u);t=new TeG.Widget.Button.LockUnlockAccount;t.memberList=this;$(".nested_block .widgetLockUnlockMember").off();$(".nested_block .widgetLockUnlockMember").on(kendo.support.click,t.Click);t.On().addListener("click",this.widgetListener.lockUnlock.click);t.On().addListener("successFlowEnd",this.widgetListener.lockUnlock.successFlowEnd);i=new TeG.Widget.Button.ChangePassword;i.memberList=this;$(".nested_block .widgetButtonChangePassword").off();$(".nested_block .widgetButtonChangePassword").on(kendo.support.click,i.Click);i.On().addListener("click",this.widgetListener.changePassword.click);i.On().addListener("successFlowEnd",this.widgetListener.changePassword.successFlowEnd);f=new TeG.Widget.Button.LoginToAccount;$(".nested_block .widgetLoginToAccount").off();$(".nested_block .widgetLoginToAccount").on(kendo.support.click,f.click);n=new TeG.Widget.Button.DeleteMember;n.memberList=this;$(".nested_block .widgetButtonDeleteMember").off();$(".nested_block .widgetButtonDeleteMember").on(kendo.support.click,n.Click);n.On().addListener("click",this.widgetListener.deleteMember.click);n.On().addListener("deleteAccountWithBalancedVisible",this.widgetListener.deleteMember.deleteAccountWithBalancedVisible);n.On().addListener("successFlowEnd",this.widgetListener.deleteMember.successFlowEnd);r=new TeG.Widget.Button.UpdateMemberProgressiveStatus;r.memberList=this;$(".nested_block .widgetUpdateMemberProgressiveStatus").off();$(".nested_block .widgetUpdateMemberProgressiveStatus").on(kendo.support.click,r.Click);r.On().addListener("click",this.widgetListener.updateMemberProgressiveStatus.click);r.On().addListener("successFlowEnd",this.widgetListener.updateMemberProgressiveStatus.successFlowEnd);e=this;$(document).off(kendo.support.click,".js-member-nested-block .edit_link");$(document).on(kendo.support.click,".js-member-nested-block .edit_link",{that:this},function(n){n.data.that.loginName=e.gridBehaivor.getSelectedRowData().LoginName;n.data.that.memberDetailsLoad.call(n.data.that)});this.nestedContentLoadConcrete();$(document).bind("NestedContentLoaded","body",function(){var n=$('div[data-role="grid"]').data("kendoGrid"),t=$("tr.k-master-row.k-state-selected").next("tr.k-detail-row:visible").find("button.widgetUpdateMemberProgressiveStatus").find("span.icon_big");t.length==1&&(t.hasClass("progressive")?($("tr.k-master-row.k-state-selected>td.progressiveStatus").attr({name:TeG.Enums.ProgressiveStatus.YES,title:TeG.Translations.ToolTipMemberProgressiveStatusYes}).html(TeG.Enums.ProgressiveStatus.YES),n.dataItem(n.select()).ProgressiveStatus=TeG.Enums.ProgressiveStatus.YES,n.dataItem(n.select()).ProgressiveStatusId=TeG.Enums.ProgressiveStatus.YES):t.hasClass("no-progressive")&&($("tr.k-master-row.k-state-selected>td.progressiveStatus").attr({name:TeG.Enums.ProgressiveStatus.NO,title:""}).html(TeG.Enums.ProgressiveStatus.NO),n.dataItem(n.select()).ProgressiveStatus=TeG.Enums.ProgressiveStatus.NO,n.dataItem(n.select()).ProgressiveStatusId=TeG.Enums.ProgressiveStatus.NO))});$("body").trigger("NestedContentLoaded")},updateBalance:function(n){n.submit.jElem.attr("disabled","disabled");n.submit.jElem.addClass("loading");tegPopups.showTotalHover();var t={};t.LoginName=n.input.jElem.attr("id").substr(19);t.Amount=n.input.jElem.val();t.CurrencyId=n.currency.jElem.is("select")?n.currency.jElem.val():n.currency.jElem.attr("data-currency-id");$.ajax({type:"POST",url:tegUrlHelper.updateBalance,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(t),balanceWidget:n,that:this,error:function(t){tegErrorHandler.processError(t,n.input.jElemLabel.html());n.submit.jElem.removeClass("loading");n.submit.jElem.removeAttr("disabled")}}).done(function(t){var r,i,u;if(!t.IsSucceed){new TeG.Validator(this.balanceWidget.input.jElem).SetMessage(t.FailureReason).ErrorRenderInHtml2();n.submit.jElem.removeAttr("disabled");n.jElemContainer.find("#updateBalanceTip").hide();n.jElemContainer.find(".js-currency-convert").hide();n.jElemContainer.find("#updateBalanceError").show();n.submit.jElem.removeClass("loading");tegPopups.closeTotalHover();return}tegPopups.closeTotalHover();n.submit.jElem.removeAttr("disabled");n.submit.jElem.removeClass("loading");r=this.that.gridBehaivor.grid.dataSource.at(this.that.gridBehaivor.grid.select()[0].rowIndex);r.Balance=Number(t.MemberBalance.replace(/,/g,""));i=n.input.jElem.attr("id").substr(19);u=$("#balance_"+i).find("div").html().replace(/[0-9\.\s\,]/g,"");$("#balance_"+i).find("div").html(TeG.Financial().CurrencyFormat(Number(t.MemberBalance.replace(/\s|\,/g,"")))+" "+u);$(".js-update-info-close").off();$(".js-update-info-close").on("click",{that:this.that},function(n){n.data.that.gridBehaivor.grid.select().find("a").click()});$(".js-member-nested-block").slideUp(function(){$(".js-update-successful").slideDown(function(){$(".js-update-info-close").focus()});$(document).trigger("UpdateBalanceDone")});TeG.InfoBlock()})},memberDetailsLoad:function(n){tegPopups.showDaisyWheelTotalHover();$.ajax({type:"GET",url:tegUrlHelper.memberDetail,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"html",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(t){var i=this.that;tegPopups.closeTotalHover();$(".js-detail").html(t);$(".js-member-list").hide();$("#memberDetailsName").html($.trim(i.gridBehaivor.getSelectedRowData().FirstName));$(".js-detail .js-back").off();$(document).on("click",".js-detail .js-back",{that:i},function(n){n.data.that.backFromDetails()});$(document).off("click","#memberDetailsDetailsTab");$(document).on("click","#memberDetailsDetailsTab",{that:i},function(n){$("#memberDetailContent").html("");$(".js-detail .tabsBar>button").removeClass("selected");$(this).addClass("selected");n.data.that.memberDetailsDetailsTab.call(n.data.that)});$(document).off("click","#memberDetailsActionTab");$(document).on("click","#memberDetailsActionTab",{that:i},function(n){$("#memberDetailContent").html("");$(".js-detail .tabsBar>button").removeClass("selected");$(this).addClass("selected");n.data.that.memberDetailsActionTab.call(n.data.that)});$(document).off("click","#memberDetailsCommissionFeeTab");$(document).on("click","#memberDetailsCommissionFeeTab",{that:i},function(n){$("#memberDetailContent").html("");$(".js-detail .tabsBar>button").removeClass("selected");$(this).addClass("selected");n.data.that.memberDetailsCommissionFeeTab.call(n.data.that)});i.memberDetailsLoadConcrete();n?n():i.memberDetailsDetailsTab();splitterResize()})},memberDetailsDetailsTab:function(){tegPopups.showDaisyWheelTotalHover();$.ajax({type:"post",url:tegUrlHelper.memberDetailsTab,data:{MemberType:this.memberType,LoginName:$.trim(this.gridBehaivor.getSelectedRowData().LoginName)},dataType:"html",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(n){var u=this.that,t,f,e,i,r;if(tegPopups.closeTotalHover(),$("#memberDetailContent").html(n),$("#IsAllElementsEnabled").val()==="False"?$("#accountDetailsTabDetails").find("input, button").not("#AccTabDetailsCancel").attr("disabled",!0):$('#accountDetailsTabDetails input[name="firstName"]').focus(),t={},$.extend(t,u.gridBehaivor.getSelectedRowData()),t.Balance=TeG.Financial().CurrencyFormat(t.Balance),t.IsBetGroupsVisible=ko.observable(!1),t.GroupCategory=ko.observable(null),t.BetGroups=ko.observableArray([]),f=[],$("#memberGroups").find("label").each(function(){f.push(parseInt($(this).attr("id")))}),e=tegFinancial.getLoginGroups({currency:t.CurrencyIsoCode,groupName:"RNGMaxPayout"}),t.GroupCategory(e.Categories[0]),t.GroupCategory()&&t.GroupCategory().Groups.length>0){i=t.GroupCategory().Groups;for(r in i)$.inArray(parseInt(i[r].MGSProfileId),f)!=-1?(i[r].shouldShowGroup=!1,i[r].selected=!0):(i[r].shouldShowGroup=!0,i[r].selected=!1);t.BetGroups(i);t.IsBetGroupsVisible(!0)}else t.IsBetGroupsVisible(!1),t.BetGroups([]);ko.cleanNode($(".js-detail").get(0));ko.applyBindings(t,$(".js-detail").get(0));TeG.ValidateElement.mobile({jElem:$('#accountDetailsTabDetails input[name="mobileNumber"]'),jElemLabel:$('#accountDetailsTabDetails label[for="mobileNumber"]'),required:!1,renderType:TeG.ValidateElement.RENDER_SLIDE_DOWN,mobPrefix:""});TeG.ValidateElement.email({jElem:$('#accountDetailsTabDetails input[name="email"]'),jElemLabel:$('#accountDetailsTabDetails label[for="email"]'),required:!1,renderType:TeG.ValidateElement.RENDER_IN_HTML2});TeG.ValidateElement.name({jElem:$('#accountDetailsTabDetails input[name="firstName"]'),jElemLabel:$('#accountDetailsTabDetails label[for="firstName"]'),required:!0,renderType:TeG.ValidateElement.RENDER_DEFAULT});TeG.ValidateElement.name({jElem:$('#accountDetailsTabDetails input[name="lastName"]'),jElemLabel:$('#accountDetailsTabDetails label[for="lastName"]'),required:!0,renderType:TeG.ValidateElement.RENDER_DEFAULT});$("#AccTabDetailsSave").off();$("#AccTabDetailsSave").on("click",{that:u},function(n){var i,e;if($('#accountDetailsTabDetails input[name="mobileNumber"]').blur(),$('#accountDetailsTabDetails input[name="email"]').blur(),$('#accountDetailsTabDetails input[name="firstName"]').blur(),$('#accountDetailsTabDetails input[name="lastName"]').blur(),!(new TeG.Validator).IsContainerHasDisplayedErrorMessage($(".TabDetailsInfo"))){i=n.data.that;data={};data.LoginName=$.trim(i.gridBehaivor.getSelectedRowData().LoginName);data.MobilePhoneNumber=$.trim($('#accountDetailsTabDetails input[name="mobileNumber"]').val());data.Email=$.trim($('#accountDetailsTabDetails input[name="email"]').val());data.FirstName=$('#accountDetailsTabDetails input[name="firstName"]').val();data.LastName=$('#accountDetailsTabDetails input[name="lastName"]').val();data.Currency=t.CurrencyIsoCode;var r=$.extend({},t.GroupCategory()),u=r.Groups,f=[];for(e in u)u[e].selected==!0&&f.push(u[e]);f.length>0?(r.Groups=f,data.GroupCategory=JSON.stringify(r)):data.GroupCategory=null;tegPopups.showTotalHover();$.ajax({type:"POST",url:tegUrlHelper.updateMemberDetails,data:JSON.stringify(data),dataObject:data,contentType:"application/json; charset=utf-8",dataType:"json",that:i,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(){var t=this.that,n;tegPopups.closeTotalHover();n=t.gridBehaivor.getSelectedRowData();$("#mobilePhoneNumber_"+this.dataObject.LoginName).html(n.MobilePhoneNumber=this.dataObject.MobilePhoneNumber);$("#email_"+this.dataObject.LoginName).html(n.Email=this.dataObject.Email);$("#firstName_"+this.dataObject.LoginName).html(n.FirstName=this.dataObject.FirstName);$("#lastName_"+this.dataObject.LoginName).html(n.LastName=this.dataObject.LastName);t.backFromDetails();t.gridBehaivor.clickRow()})}});$("#AccTabDetailsCancel").off();$("#AccTabDetailsCancel").on("click",{that:u},function(n){n.data.that.backFromDetails()})})},memberDetailsActionTab:function(){tegPopups.showDaisyWheelTotalHover();var n={};n.LoginName=$.trim(this.gridBehaivor.getSelectedRowData().LoginName);$.ajax({type:"POST",url:tegUrlHelper.membersActionsTab,contentType:"application/json; charset=utf-8",data:JSON.stringify(n),dataType:"html",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(n){var t=this.that,r,u,i,f,e,o;tegPopups.closeTotalHover();$("#memberDetailContent").html(n);$(".detailsBody .js-lockUnlock").html($(".js-member-nested-block .widgetLockUnlockMember").parent().html());$(".detailsBody .js-changePassword").html($(".js-member-nested-block .widgetButtonChangePassword").parent().html());$(".detailsBody .js-deleteMember").html($(".js-member-nested-block .widgetButtonDeleteMember").parent().html());$(".detailsBody .js-UpdateMemberProgressiveStatus").html($(".js-member-nested-block .widgetUpdateMemberProgressiveStatus").parent().html());r=new TeG.Widget.Button.LockUnlockAccount;r.memberList=t;$(".js-detail .widgetLockUnlockMember").off();$(".js-detail .widgetLockUnlockMember").on("click",r.Click);r.On().addListener("click",t.widgetListener.lockUnlock.click);r.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);r.On().addListener("successFlowEnd",t.widgetListener.lockUnlock.successFlowEnd);u=new TeG.Widget.Button.ChangePassword;u.memberList=t;$(".js-detail .widgetButtonChangePassword").off();$(".js-detail .widgetButtonChangePassword").on("click",u.Click);u.On().addListener("click",t.widgetListener.changePassword.click);u.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);u.On().addListener("successFlowEnd",t.widgetListener.changePassword.successFlowEnd);i=new TeG.Widget.Button.DeleteMember;i.memberList=t;$(".js-detail .widgetButtonDeleteMember").off();$(".js-detail .widgetButtonDeleteMember").on("click",i.Click);i.On().addListener("click",t.widgetListener.deleteMember.click);i.On().addListener("deleteAccountWithBalancedVisible",t.widgetListener.deleteMember.deleteAccountWithBalancedVisibleFromDetail);i.On().addListener("deleteAccountWithBalancedVisible",t.widgetListener.deleteMember.deleteAccountWithBalancedVisible);i.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);i.On().addListener("successFlowEnd",t.widgetListener.deleteMember.successFlowEnd);f=new TeG.Widget.Button.SuspendLockNetwork;f.memberList=t;$(".js-detail .widgetResumeSuspend").off();$(".js-detail .widgetResumeSuspend").on("click",f.click);f.On().addListener("successFlowStart",t.widgetListener.suspendLockNetwork.successFlowStart);f.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);f.On().addListener("successFlowEnd",t.widgetListener.suspendLockNetwork.successFlowEnd);e=new TeG.Widget.Button.LockUnlockNetwork;e.memberList=t;$(".js-detail .widgetLockUnlockNetwork").on("click",e.click);e.On().addListener("successFlowStart",t.widgetListener.suspendLockNetwork.successFlowStart);e.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);e.On().addListener("successFlowEnd",t.widgetListener.suspendLockNetwork.successFlowEnd);o=new TeG.Widget.Button.UpdateMemberProgressiveStatus;o.memberList=t;$(".js-detail .widgetUpdateMemberProgressiveStatus").off();$(".js-detail .widgetUpdateMemberProgressiveStatus").on("click",o.Click);o.On().addListener("click",t.widgetListener.updateMemberProgressiveStatus.click);o.On().addListener("successFlowEnd",t.widgetListener.common.closeDetailBlock);o.On().addListener("successFlowEnd",t.widgetListener.updateMemberProgressiveStatus.successFlowEnd);$("body").trigger("MemberDetailsActionTabLoaded")})},memberDetailsCommissionFeeTab:function(){tegPopups.showDaisyWheelTotalHover();var n=this,t={};t.LoginName=$.trim(this.gridBehaivor.getSelectedRowData().LoginName);$.ajax({type:"GET",url:tegUrlHelper.membersCommissionFeeTab+"?time="+(new Date).getTime(),data:t,dataType:"html",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(t){var f=this.that,e,r,i,u;tegPopups.closeTotalHover();$("#memberDetailContent").html(t);for(e in $(".js-detail .commission-fee-area .only-digits"))r=TeG.Widget.getBalanceBehaivor("OnlyPositiveNumberInInput"),r.input.jElem=$(".js-detail .commission-fee-area .only-digits").eq(e),r.activate();i=$(".show-nested:checked").next();i.show();u=i.find(".nested:visible");u.length>0?u.find(".small-input").addClass("validation"):i.find(".small-input").addClass("validation");var o=function(n){var t=n.next();t.find(".focus:first").focus()},s=function(n,t){if(!t.find(":checkbox:checked").length){var i=n.closest(".nested").find(":checkbox").not(n);return i.prop("checked",!0),i}return!1},h=function(n){n.find(":checkbox:checked").length===2&&(n.find(".small-input").blur(),(new TeG.Validator).CleanAllError(n))};$(".show-nested").change(function(){var n=s($(this),$(".at-least-one-checked"))||$(this);$(".show-nested").each(function(){var n=$(this).next();$(this).is(":checked")?n.slideDown("fast",function(){$(this).find(".small-input").addClass("validation");splitterResize()}):(n.find(".validation").removeClass("validation"),n.find(".small-input").each(function(){$(this).val($(this).data("value"))}),(new TeG.Validator).CleanAllError(n),n.slideUp("fast",function(){$(this).find(".show-nested").each(function(){$(this).data("checked")!=1?$(this).prop("checked",!1):$(this).prop("checked",!0)});splitterResize()}))});o(n);h($(".at-least-one-checked"))});$("#formCommissionFee .validation").on("blur",function(){$("#rolling-values-table .validation").each(function(){var n=$(this).closest(".nested").parent().children("label"),t=$(this).hasClass("allow-zero")?0:.01;validator=new TeG.Validator($(this));validator.MinNumberListener(TeG.Translations.ValidateInvalidLabelFieldLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,"")),Number($(this).val()),t).MaxNumberListener(TeG.Translations.ValidateInvalidLabelFieldLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,"")),Number($(this).val()),100).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,""))).ErrorRenderCommonMessage()});$.each(["netcash-based-percent","netwin-based-percent"],function(n,t){var i=$("#"+t);i.hasClass("validation")&&new TeG.Validator(i).MinNumberListener(TeG.Translations.ValidateInsertValidNumericValue,Number(i.val()),i.hasClass("allow-zero")?0:.01).MaxNumberListener(TeG.Translations.ValidateInsertValidNumericValue,Number(i.val()),100).RequiredListener(TeG.Translations.ValidateInsertValidNumericValue).ErrorRenderCommonMessage()})});$("#AccTabCommissionFeeSave").off();$("#AccTabCommissionFeeSave").on("click",{that:f},function(t){var u=t.data.that,r,i;if(t.preventDefault(),r=$("#formCommissionFee > .input-block").has(".nested:visible").find(".nested:visible").not(".at-least-one-checked"),r.find(".validation").blur(),r.length>0&&(new TeG.Validator).IsContainerHasCommonErrorMessage(r))return!1;i=new TeG.Popups2.Confirmation("notice");i.setOkCaption($("#ok-button-caption").val());tegPopups.showTotalHover();i.show($("#commissionfee-confirmation-popup-heading").val(),$("#commissionfee-popup-confirmation-message").val(),!0);i.memberList=u;i.okButtonHandler=function(t){var e=t.data.that,o=$("#formCommissionFee :input:radio, #formCommissionFee :input:checkbox"),i={},u,r,f;o.each(function(){var n=Number($(this).is(":checked"));i[this.id]=n});i["netcash-based-percent"]=$("#netcash-based-percent").val();i["netwin-based-percent"]=$("#netwin-based-percent").val();u=$("#rolling-values-table > tr");r=[];u.each(function(n){r[n]={ContentCategoryId:$(this).data("id"),CommissionValue:Number($("#rolling-comission-value-"+$(this).data("id")).val()),EffectiveIncome:Number($("#rolling-effective-income-"+$(this).data("id")).val())}});f={LoginName:$.trim(e.memberList.gridBehaivor.getSelectedRowData().LoginName),NetCash:i["commission-netcash-radio"]!==0?Number(i["netcash-based-percent"]):null,NetWin:i["commission-results-radio"]!==0&&i["netwin-based-cb"]!==0?Number(i["netwin-based-percent"]):null,RollingDetails:i["commission-results-radio"]!==0&&i["rollingfee-based-cb"]!==0?r:null};$.ajax({type:"POST",url:tegUrlHelper.updateCommission,contentType:"application/json; charset=utf-8",data:JSON.stringify(f),dataType:"json",that:this,error:function(){var n=new TeG.Popups2.Error;n.setCloseCaption("OK");n.show($("#commissionfee-confirmation-popup-heading").val(),$("#commissionfee-popup-error-message").val())}}).done(function(t){var r,i,u;t.IsSucceed===!0?(i=this.that,i.hide(),r=new TeG.Popups2.Success("green"),r.setOkCaption("OK"),r.show($("#commissionfee-confirmation-popup-heading").val(),$("#commissionfee-popup-success-message").val()),r.okButtonHandler=function(t){var i=t.data.that;n.backFromDetails();n.gridBehaivor.clickRow()}):(i=this.that,i.hide(),u=new TeG.Popups2.Error("notice"),u.setCloseCaption("OK"),u.show($("#commissionfee-confirmation-popup-heading").val(),t.FailureReason),u.okButtonHandler=function(t){var i=t.data.that;n.backFromDetails();n.gridBehaivor.clickRow()})})}});$("#AccTabCommissionFeeCancel").off();$("#AccTabCommissionFeeCancel").on("click",{that:f},function(n){n.data.that.backFromDetails()});splitterResize()})},backFromDetails:function(){var t=$('div[data-role="grid"]').data("kendoGrid"),n=[];$(".js-detail").html("");$(".js-member-list").show();n=$('div[data-role="grid"]').find("tr.k-detail-row:visible").prev();n.length>0&&t.select($(n))},widgetListener:{lockUnlock:{click:function(){this.source.url=tegUrlHelper.changeMemberStatus;delete this.source.data.accountNumber;delete this.source.data.accountStatus;this.source.data.LoginName=this.source.elem.attr("id").substring(14);this.source.data.MemberStatus=$(this.source.elem.find("span").get(1)).hasClass("lock")?"Lock":"Open"},successFlowEnd:function(){var n=$("tr.k-state-selected").prevAll().length;this.source.memberList.gridBehaivor.grid.dataSource._data[n].StatusHtml=$("#status_"+this.source.accountNumber).html();this.source.memberList.gridBehaivor.clickRow();this.source.memberList.gridBehaivor.clickRow()}},updateMemberProgressiveStatus:{click:function(){this.source.url=tegUrlHelper.updateMemberProgressiveStatus;this.source.data.LoginName=this.source.memberList.gridBehaivor.getSelectedRowData().LoginName;this.source.data.ProgressiveStatus=$(this.source.elem.find("span.icon_big")).hasClass("progressive")?TeG.Enums.ProgressiveStatus.NO:TeG.Enums.ProgressiveStatus.YES},successFlowEnd:function(){var t=$("tr.k-state-selected").prevAll().length,n=0;$(this.source.elem).is(":visible")||(this.source.elem=$('div[data-role="grid"]').find("button#updateMemberProgressiveStatusRef_"+this.source.memberList.gridBehaivor.getSelectedRowData().LoginName));n=$(this.source.elem).find("span.icon_big").hasClass("no-progressive")?TeG.Enums.ProgressiveStatus.PendingForEnable:TeG.Enums.ProgressiveStatus.PendingForDisable;this.source.memberList.gridBehaivor.grid.dataSource._data[t].ProgressiveStatus=n;this.source.memberList.gridBehaivor.grid.dataSource._data[t].ProgressiveStatusId=n;$("tr.k-state-selected>td.progressiveStatus").attr("name",n);$("tr.k-state-selected>td.progressiveStatus.progressiveStatus").html(n);switch(Number($("tr.k-state-selected>td.progressiveStatus").attr("name"))){case TeG.Enums.ProgressiveStatus.NO:$("tr.k-state-selected>td.progressiveStatus").attr("title","");break;case TeG.Enums.ProgressiveStatus.YES:case TeG.Enums.ProgressiveStatus.ThresholdBlocked:case TeG.Enums.ProgressiveStatus.ThresholdAlerted:$("tr.k-state-selected>td.progressiveStatus").attr("title",TeG.Enums.ProgressiveStatus.YES);break;case TeG.Enums.ProgressiveStatus.PendingForEnable:$("tr.k-state-selected>td.progressiveStatus").attr("title",TeG.Translations.ToolTipMemberProgressiveStatusPendingToAdd);break;case TeG.Enums.ProgressiveStatus.PendingForDisable:$("tr.k-state-selected>td.progressiveStatus").attr("title",TeG.Translations.ToolTipMemberProgressiveStatusPendingToRemove)}$(this.source.elem).find("span.icon_big").removeClass("no-progressive").removeClass("progressive").addClass("progressive-inprogress");this.source.memberList.gridBehaivor.clickRow();this.source.memberList.gridBehaivor.clickRow()}},changePassword:{click:function(){this.source.url=this.source.memberList.widgetChangePasswordUrl;this.source.setFirstName($("#firstName_"+this.source.accountNumber).html());this.source.setEmail($("#email_"+this.source.accountNumber).html());this.source.setSms($("#mobilePhoneNumber_"+this.source.accountNumber).html());$(".js-changePasswordConfirmationRequest").html($(".js-changePasswordConfirmationRequestHidden").html().replace(/%%name%%/,'<span class="textBold">'+$("#firstName_"+this.source.accountNumber).html()+"<\/span>"))},successFlowEnd:function(){this.source.memberList.gridBehaivor.clickRow()}},deleteMember:{click:function(){var n=$("#balance_"+this.source.login).find("div").html().replace(/[A-Za-z\s\,]/g,"");this.source.isNotEmptyBalance=Number(n)>0?!0:!1;this.source.memberName=$("#firstName_"+this.source.login).html()+" "+$("#lastName_"+this.source.login).html()},deleteAccountWithBalancedVisible:function(){$(".js-toolbar-delete-balanced .js-back").off();$(".js-toolbar-delete-balanced .js-back").on("click",{that:this},function(){$(".js-member-list").show();$(".js-accounts-with-balances-for-delete").html("")});var n=$("#"+getAccountDeletedBalancedGridParams().name).data("kendoGrid");n.bind("dataBound",function(){TeG.Utils().setTypeIcons("AccountType",n)});$(".js-accounts-with-balances-for-delete .print").off();$(".js-accounts-with-balances-for-delete .print").on("click",{that:this},function(){var n=new(TeG.Print().PrintGrid);n.setGrid($("#"+getAccountDeletedBalancedGridParams().name).data("kendoGrid"));n.setTitle(getAccountDeletedBalancedGridParams().printTitle);n.store().open()});splitterResize()},deleteAccountWithBalancedVisibleFromDetail:function(){$(".js-detail").html("")},successFlowEnd:function(){this.source.memberList.gridBehaivor.refresh()}},suspendLockNetwork:{click:function(){},successFlowStart:function(){this.source.memberName=this.source.memberList.gridBehaivor.getSelectedRowData().FirstName+" "+this.source.memberList.gridBehaivor.getSelectedRowData().LastName},successFlowEnd:function(){this.source.memberList.gridBehaivor.refreshSelectExpand()}},common:{closeDetailBlock:function(){$(".js-detail").html("");$(".js-member-list").show()}}}},Add:{ModelInit:function(n){var t=this;this.Service={PhonePrefix:ko.observable(""),PhoneNumber:ko.observable(""),ConfirmationEmailCheck:ko.observable(!0),ConfirmationEmailFocus:ko.observable(!1),ConfirmationPhoneCheck:ko.observable(!1),ConfirmationPhoneFocus:ko.observable(!1)};this.Service.ConfirmationEmailClassError=ko.computed(function(){return $(".js-error-adddMemberSendEmail").html()!=""&&this.Service.ConfirmationEmailCheck()},this);this.Service.ConfirmationEmailCheck.subscribe(function(n){n?($(".js-error-adddMemberSendEmail").show(),this.Service.ConfirmationEmailFocus(!0)):$(".js-error-adddMemberSendEmail").hide();n||this.Service.ConfirmationPhoneCheck()||this.Service.ConfirmationPhoneCheck(!0)},this);this.Service.ConfirmationPhoneClassError=ko.computed(function(){return $(".js-error-addMemberSendSMS").html()!=""&&this.Service.ConfirmationPhoneCheck()},this);this.Service.ConfirmationPhoneCheck.subscribe(function(n){n?($(".js-error-addMemberSendSMS").show(),this.Service.ConfirmationPhoneFocus(!0)):$(".js-error-addMemberSendSMS").hide();n||this.Service.ConfirmationEmailCheck()||this.Service.ConfirmationEmailCheck(!0)},this);this.FirstName=ko.observable("");this.LastName=ko.observable("");this.Email=ko.observable("");this.Email.subscribe(function(){$(".js-error-adddMemberSendEmail").hide()});this.PhonePrefix=ko.observable("");this.PhoneNumber=ko.observable("");this.ConfirmationPhoneNumber=ko.observable("");this.MobilePhoneNumber=ko.computed(function(){return this.Service.PhoneNumber()?this.Service.PhonePrefix().replace(/\s*\+*\s*|\s*/g,"")+this.Service.PhoneNumber():""},this);this.ConfirmationEmail=ko.observable("");this.Password=ko.observable("");this.PasswordConfirmation=ko.observable("");this.Password.subscribe(function(){$("#add-confirm-password").focus();$("#add-confirm-password").blur()},n);this.PasswordConfirmation.subscribe(function(){$("#add-password").focus();$("#add-password").blur()},n);this.CountryId=ko.observable(0);this.CountryId.subscribe(function(n){var t=$('#addMemberCountry option[value="'+n+'"]').attr("data-phonecode").replace(/\s*\+*\s*|\s*/g,"");this.ConfirmationPhoneNumber(this.ConfirmationPhoneNumber().replace(t,""))},this,"beforeChange");this.CountryId.subscribe(function(n){var t=$('#addMemberCountry option[value="'+n+'"]').attr("data-phonecode").replace(/\s*\+*\s*|\s*/g,"");this.ConfirmationPhoneNumber(t.replace(/\s*\+*\s*|\s*/g,"")+this.ConfirmationPhoneNumber())},this);this.CountryId.subscribe(function(){tegPopups.showDaisyWheelTotalHover();$.ajax({type:"POST",url:tegUrlHelper.getTimeZoneByCountryId,data:JSON.stringify({CountryId:Number(this.CountryId())}),contentType:"application/json",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(n){var r=this.that,i,t;for(r.Service.TimeZone_arr.removeAll(),i=null,t=0;t<n.TimeZones.length;t++)r.Service.TimeZone_arr.push(n.TimeZones[t]),n.TimeZones[t].IsDefault&&(i=n.TimeZones[t].Id);i&&r.TimeZoneId(i);tegPopups.closeTotalHover()})},this);this.TimeZoneId=ko.observable(0);this.IsEnableProgressiveVisible=ko.observable(TeG.GlobalVariables.IsLoggedinMemberProgressive);this.IsProgressive=ko.observable(TeG.GlobalVariables.IsLoggedinMemberProgressive);this.Service.TimeZone_arr=ko.observableArray();this.CurrencyId=ko.observable(0);this.Service.SelectedCurrencyIso=ko.computed(function(){return $("#add-currency").index()!==-1?$('#add-currency option[value="'+this.CurrencyId()+'"]').html():$("#addMemberIsoCode").html()},this);this.IsBetGroupsVisible=ko.observable(!1);this.GroupCategory=ko.observable(null);this.BetGroups=ko.observableArray([]);this.GroupChange=function(){};this.GroupClick=function(n){var r=t.BetGroups().length,i=0;if(ko.utils.arrayForEach(t.BetGroups(),function(n){n.selected&&(i+=1)}),i>0)return!0;n.selected=!0};this.CurrencyId.subscribe(function(){var r=tegFinancial.getLoginGroups({currency:t.Service.SelectedCurrencyIso(),groupName:"RNGMaxPayout"}),n,i;if(t.GroupCategory(r.Categories[0]),t.GroupCategory()&&t.GroupCategory().Groups.length>0){n=t.GroupCategory().Groups;for(i in n)n[i].selected=n[i].IsDefault==1?!0:!1;t.BetGroups(n);t.IsBetGroupsVisible(!0)}else t.IsBetGroupsVisible(!1),t.BetGroups([])});this.UpdateBalanceAmount=ko.observable("0");this.NetWinCb=ko.observable(!1);this.NetWinCb.subscribe(function(n){n||this.NetWin("")},this);this.NetCash=ko.observable("");this.NetWin=ko.observable("");this.NetCash.subscribe(function(n){n&&this.NetWin("")},this);this.NetWin.subscribe(function(n){n&&this.NetCash("");this.NetWin(n)},this);this.Service.PhoneNumber.subscribe(function(n){this.ConfirmationPhoneNumber(this.Service.PhonePrefix().replace(/\s*\+*\s*|\s*/g,"")+n)},this);this.Email.subscribe(function(n){this.ConfirmationEmail(n)},this);this.Service.Currency=ko.computed(function(){var n=$.trim(this.UpdateBalanceAmount())?this.UpdateBalanceAmount():"0";return $("#add-currency").index()!==-1?n+" "+$("#add-currency").find("option:selected").html():n+" "+$("#addMemberIsoCode").html()},this);this.Service.EmptyCurrency=ko.computed(function(){return"0.00 "+this.Service.SelectedCurrencyIso()},this)},model:{},modelActivate:function(){var n=this;ko.applyBindings(n.model,$("#addMember").get(0));n.model.ConfirmationPhoneNumber(n.model.Service.PhonePrefix().replace(/\s*\+*\s*|\s*/g,""));$("#ho-currency-id").length>0&&n.model.CurrencyId(parseInt($("#ho-currency-id").val()));window.m=n.model},activate:function(){function n(n){var t=tegGeoApi.getIsoCode();$("#addMemberCountry").find("option").each(function(i,r){$(r).attr("data-countryisocode")==t&&(n.CountryId($(r).val()),n.Service.PhonePrefix($(r).attr("data-phonecode")))})}TeG.Popups2.showTotalHover();$.ajax({type:"POST",url:this.addPageUrl,contentType:"application/x-www-form-urlencoded; charset=UTF-8",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(t){var i=this.that;$("#DivMembersGrid").hide();$("#addRemoveAgents").show();$("#addMember").append(t).show();i.model=new i.ModelInit(i);$("#backToAgentsGrid").off();$("#backToAgentsGrid").on("click",{that:i},function(n){ko.cleanNode($("#addMember").get(0));var t=n.data.that;t.hide()});TeG.Popups2.closeTotalHover();$("#addMemberFirstName").off();$("#addMemberFirstName").on("blur",{that:i},function(n){n.data.that.validate.firstName()});$("#addMemberLastName").off();$("#addMemberLastName").on("blur",{that:i},function(n){n.data.that.validate.lastName()});$("#addMemberEmail").off();$("#addMemberEmail").on("blur",{that:i},function(n){n.data.that.validate.email()});$("#addMemberCountry").off();$("#addMemberCountry").on("blur",{that:i},function(n){n.data.that.validate.country()});$("#addMemberCountry").on("change",{that:i},function(n){n.data.that.model.Service.PhonePrefix($("#addMemberCountry").find(":selected").attr("data-phonecode"))});n(i.model);$("#addMemberMobileNumber").off();$("#addMemberMobileNumber").on("blur",{that:i},function(n){n.data.that.validate.mobile()});$("#add-password-checkbox").off();$("#add-password-checkbox").on("click",{that:i},function(n){$("#add-password-block").is(":visible")?($("#add-password-block").slideUp(splitterResize),(new TeG.Validator).SetRenderErrorType("inHtml2").CleanError($("#add-password")),(new TeG.Validator).SetRenderErrorType("inHtml2").CleanError($("#add-confirm-password")),n.data.that.model.Password(""),n.data.that.model.PasswordConfirmation("")):$("#add-password-block").slideDown(splitterResize)});$("#add-password").off();$("#add-password").on("blur",{that:i},function(n){$("#add-password-block").is(":visible")&&n.data.that.validate.enterPassword()});$("#add-confirm-password").off();$("#add-confirm-password").on("blur",{that:i},function(n){$("#add-password-block").is(":visible")&&n.data.that.validate.confirmPassword()});$("#adddMemberSendEmail").off();$("#adddMemberSendEmail").on("blur",{that:i},function(n){$("#addMemberSendEmailCheckBox").is(":checked")&&n.data.that.validate.confirmEmail()});$("#addMemberSendSMS").off();$("#addMemberSendSMS").on("blur",{that:i},function(n){$("#adddMemberSendSMSCheckBox").is(":checked")&&n.data.that.validate.confirmSms()});i.commission();$("#addMemberAddButton").off();$("#addMemberAddButton").on("click",{that:i},function(n){var i,t,e;if(new TeG.ValidateElement.passwordPairOnSubmit({jPass:$("#add-password"),jConf:$("#add-confirm-password"),renderType:TeG.ValidateElement.RENDER_IN_HTML2}),$("#addMember input").add("#addMember select").blur(),!(new TeG.Validator).IsContainerHasDisplayedErrorMessage($("#addMember"))){TeG.Popups2.showDaisyWheelTotalHover();i=n.data.that;t=ko.toJS(i.model);t.CurrencyId===0&&(t.CurrencyId=$("#ho-currency-id").val());$.trim(t.Service.PhoneNumber)==""&&delete t.MobilePhoneNumber;$("#add-password-checkbox").is(":checked")&&(delete t.Password,delete t.PasswordConfirmation);t.Service.ConfirmationEmailCheck||delete t.ConfirmationEmail;t.Service.ConfirmationPhoneCheck||delete t.ConfirmationPhoneNumber;t.UpdateBalanceAmount==""&&(t.UpdateBalanceAmount=0);delete t.Service;$("#rolling-values-table").is(":visible")&&(t.RollingDetails=[],$(".js-add-rolling").each(function(){t.RollingDetails.push({ContentCategoryId:$(this).attr("data-id"),CommissionValue:$(this).find(".js-rolling").val(),EffectiveIncome:$(this).find(".js-effective").val()})}));var r=$.extend({},i.model.GroupCategory()),u=r.Groups,f=[];for(e in u)u[e].selected==!0&&f.push(u[e]);f.length>0?(r.Groups=f,t.GroupCategory=JSON.stringify(r)):t.GroupCategory=null;delete t.BetGroups;$.ajax({type:"POST",url:tegUrlHelper.memberCreate,contentType:"application/json; charset=utf-8",data:JSON.stringify(t),dataType:"json",that:i,error:function(n){TeG.Popups2.totalHoverRemoveDaisyWheel();tegErrorHandler.processError(n,TeG.Translations.PopupError)},timeout:12e4}).done(function(n){var t,f,o,r,i,u,e;ko.cleanNode($("#addMember").get(0));TeG.Popups2.totalHoverRemoveDaisyWheel();t=this.that;n.IsSucceed?(r=TeG.Popups2.ICON_SUCCESS,i=t.model.UpdateBalanceAmount()==0?t.model.Service.EmptyCurrency():t.model.Service.Currency()):n.IsCreated&&!n.IsBalanceUpdated?(r=TeG.Popups2.ICON_EXCLAMATION,i=t.model.Service.EmptyCurrency()):(f=new TeG.Popups2.Error(TeG.Popups2.ICON_NOTICE),f.setCloseCaption("OK"),o=n.FailureReason?n.FailureReason:TeG.Translations.PopupError,f.show(TeG.Translations.CommissionFee,o));t.memberType=="HeadOffice"?u=TeG.Popups2.TYPE_MASTER_AGENT:t.memberType=="MasterAgent"&&(u=TeG.Popups2.TYPE_AGENT,i||(i=$("#AddMemberCasinoCreditBalance").val()+" "+$("#default-currency").html()));e=new TeG.Popups2.CreateMember(r,u);t.LoginName=n.LoginName;e.okButtonHandler=function(){t.hide();var n=t.memberType=="HeadOffice"?tegMasterAgentList:tegMemberAgentList;n.gridBehaivor.globalSearchJElem.val(t.LoginName);n.gridBehaivor.refresh();!$.browser.safari||TeG.isMobile()||TeG.isIPad()||$("#cancelSearch").css("left","170px")};TeG.InfoBlock();e.assignModel({Login:n.LoginName,Password:n.Password,Balance:i}).show()})}});$("#addMemberCancelButton").off();$("#addMemberCancelButton").on("click",{that:i},function(n){n.data.that.hide()});i.init();i.modelActivate();splitterResize()})},validate:{firstName:function(){new TeG.Validator($("#addMemberFirstName")).PlayerUnsupportedListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$("#addMemberFirstNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).PlayerIncorrectListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$("#addMemberFirstNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,$("#addMemberFirstNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).DisplayErrorMessageOffsetTop(2).ErrorRenderDefault()},lastName:function(){new TeG.Validator($("#addMemberLastName")).PlayerUnsupportedListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$("#addMemberLastNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).PlayerIncorrectListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$("#addMemberLastNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,$("#addMemberLastNameLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).DisplayErrorMessageOffsetTop(2).ErrorRenderDefault()},email:function(){new TeG.Validator($("#addMemberEmail")).EmailIncorrectListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#addMemberEmailLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).EmailUnsupportedCharsListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#addMemberEmailLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).DisplayErrorMessageOffsetTop(2).ErrorRenderDefault()},country:function(){new TeG.Validator($("#addMemberCountry")).Not0NumberListener(TeG.Translations.ValidateSelectField.replace(/%%field_label%%/,$("#lblForCountry").html().replace(/^s*|\*|\:|\s*$/g,""))).DisplayErrorMessageOffsetTop(9).ErrorRenderDefault()},mobile:function(){new TeG.Validator($("#addMemberMobileNumber")).MobileNumberIncorrectListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#lblForMobileNumber").html().replace(/^s*|\*|\:|\s*$/g,"")),$("#addMemberMobilePrefix").text().replace(/\s|\+/g,"")).MobileNumberUnsupportedCharsListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#lblForMobileNumber").html().replace(/^s*|\*|\:|\s*$/g,""))).ErrorRenderDefault()},enterPassword:function(){new TeG.Validator($("#add-password")).PasswordUnsupportedListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$('label[for="add-password"]').html().replace(/\*|\:/g,""))).PasswordIncorrectListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$('label[for="add-password"]').html().replace(/\*|\:/g,""))).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,$('label[for="add-password"]').html().replace(/\*|\:/g,""))).DisplayErrorMessageOffsetTop(2).ErrorRenderInHtml2()},confirmPassword:function(){new TeG.Validator($("#add-confirm-password")).PasswordUnsupportedListener(TeG.Translations.ValidateInsertFieldInCorrectFormat.replace(/%%field_label%%/,$('label[for="add-confirm-password"]').html().replace(/\*|\:/g,""))).RepeatPasswordListener(TeG.Translations.ValidatePasswordNotMatch,$("#add-password").val()).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,$('label[for="add-confirm-password"]').html().replace(/\*|\:/g,""))).ErrorRenderInHtml2()},confirmEmail:function(){new TeG.Validator($("#adddMemberSendEmail")).EmailIncorrectListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#addMemberEmailLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).EmailUnsupportedCharsListener(TeG.Translations.ValidateInvalidFieldCheckAndTryAgain.replace(/%%field_label%%/,$("#addMemberEmailLabel").html().replace(/^s*|\*|\:|\s*$/g,""))).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,$("#lblForAddMemberSendEmailCheckBox").html().replace(/^s*|\*|\:|\s*$/g,""))).DisplayErrorMessageOffsetTop(2).ErrorRenderInHtml2()},confirmSms:function(){new TeG.Validator($("#addMemberSendSMS")).MobileNumberIncorrectListener(TeG.Translations.ValidateInvalidMobileNumber).MobileNumberUnsupportedCharsListener(TeG.Translations.ValidateInvalidMobileNumber).RequiredListener(TeG.Translations.ValidateInsertMobileNumber).ErrorRenderInHtml2()},betGroups:function(){new TeG.Validator($(".bet-group-area")).CheckboxRequiredListener(TeG.Translations.ValidateSelectBetGroup).ErrorRenderInHtml2()}},commission:function(){var o=this,r,t,n,i;for(r in $(".commission-fee-area .only-digits"))t=TeG.Widget.getBalanceBehaivor("OnlyPositiveNumberInInput"),t.input.jElem=$(".commission-fee-area .only-digits").eq(r),t.activate();n=$(".show-nested:checked").next();n.show();i=n.find(".nested:visible");i.length>0?i.find(".small-input").addClass("validation"):n.find(".small-input").addClass("validation");var u=function(n){var t=n.next();t.find(".focus:first").focus()},f=function(n,t){if(!t.find(":checkbox:checked").length){var i=n.closest(".nested").find(":checkbox").not(n);return i.prop("checked",!0),i}return!1},e=function(n){n.find(":checkbox:checked").length===2&&(n.find(".small-input").blur(),(new TeG.Validator).CleanAllError(n))};$(".show-nested").change(function(){var n=f($(this),$(".at-least-one-checked"))||$(this);$(".show-nested").each(function(){var n=$(this).next();$(this).is(":checked")?n.slideDown("fast",function(){$(this).find(".small-input").addClass("validation");splitterResize()}):(n.find(".validation").removeClass("validation"),n.find(".small-input").each(function(){$(this).val($(this).data("value"))}),(new TeG.Validator).CleanAllError(n),n.slideUp("fast",function(){$(this).find(".show-nested").each(function(){$(this).data("checked")!=1?$(this).prop("checked",!1):$(this).prop("checked",!0)});splitterResize()}))});u(n);e($(".at-least-one-checked"))});$("#formCommissionFee .validation").on("blur",function(){$("#rolling-values-table .validation").each(function(){var n=$(this).closest(".nested").parent().children("label"),t=$(this).hasClass("allow-zero")?0:.01;validator=new TeG.Validator($(this));validator.MinNumberListener(TeG.Translations.ValidateInvalidLabelFieldLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,"")),Number($(this).val()),t).MaxNumberListener(TeG.Translations.ValidateInvalidLabelFieldLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,"")),Number($(this).val()),100).RequiredListener(TeG.Translations.ValidatePleaseInsertYourLabel.replace(/%%field_label%%/,n.html().replace(/^s*|\*|\:|\s*$/g,""))).ErrorRenderCommonMessage()});$.each(["netcash-based-percent","netwin-based-percent"],function(n,t){var i=$("#"+t);new TeG.Validator(i).MinNumberListener(TeG.Translations.ValidateInsertValidNumericValue,Number(i.val()),i.hasClass("allow-zero")?0:.01).MaxNumberListener(TeG.Translations.ValidateInsertValidNumericValue,Number(i.val()),100).RequiredListener(TeG.Translations.ValidateInsertValidNumericValue).ErrorRenderCommonMessage()})})},hide:function(){$("#addMember").html("");$("#addRemoveAgents").hide();$("#DivMembersGrid").show();splitterResize()}}};TeG.MemberAgent={List:function(){this.memberType="MasterAgent";this.init=function(){$("#addNewAgentTool").off();$("#addNewAgentTool").on("click",{that:this},function(n){var i=n.data.that,t=new TeG.MemberAgent.Add;t.activate()});this.widgetLockUnlockUrl=tegUrlHelper.updateMemberAccountStatus;this.widgetChangePasswordUrl=tegUrlHelper.membersChangeAgentPassword};this.nestedContentLoadConcrete=function(){var n=TeG.Widget.getBalanceBehaivor("MasterAgentUpdateOneCurrency");n.currency.jElem=$("#updateBalanceBlock").find(".js-currency-span");n.input.minValue=$("#balance_"+$(".js-updateBalanceInput").attr("id").substring(19)).find("div").html().replace(/([0-9,\s.]*).*/,"$1").replace(/\s|\,/g,"");n.jElemContainer=$("#updateBalanceBlock");n.input.jElem=$(".js-updateBalanceInput");n.input.jElemLabel=$(".js-update-balance");n.input.jElemError=$("#updateBalanceError");n.currency.jElemConvert=$("#updateBalanceTip");n.submit.jElem=$(".js-update-balance-btn");n.submit.action=function(){if(["","-",".","-."].indexOf(this.input.jElem.val())>-1||Number(this.input.jElem.val())==0){new TeG.Validator(this.input.jElem).SetMessage(TeG.Translations.ValidateInsertValidNumericValue).ErrorRenderInHtml2();$("#updateBalanceBlock").find(".js-tip").hide();return}this.memberList.updateBalance.call(this.memberList,n)};n.memberList=this;n.activate()};this.memberDetailsLoadConcrete=function(){$("#memberDetailsAgentsDetailsTab").hide();$("#memberDetailsBlock .js-type").html($("#memberDetailsBlock .js-type").attr("data-MA"));$("#memberDetailsBlock .js-back").html($("#memberDetailsBlock .js-back").attr("data-MABack"))}},Add:function(){this.memberType="MasterAgent";this.addPageUrl=tegUrlHelper.addMemberAgentPage;this.init=function(){var n=TeG.Widget.getBalanceBehaivor("Standart");n.jElemContainer=$("#balance-container");n.input.jElem=$("#AddMemberCasinoCreditBalance");n.input.jElemLabel=$('label[for="AddMemberCasinoCreditBalance"]');n.activate();this.model.CurrencyId($("#default-currency").attr("data-value"))}}};TeG.MemberAgent.List.prototype=TeG.MemberParent.List;TeG.MemberAgent.List.prototype.constructor=TeG.MemberAgent.List;TeG.MemberAgent.Add.prototype=TeG.MemberParent.Add;TeG.MemberAgent.Add.prototype.constructor=TeG.MemberAgent.Add;TeG.MasterAgent={List:function(){this.memberType="HeadOffice";this.init=function(){$("#addNewAgentTool").off();$("#addNewAgentTool").on("click",{that:this},function(n){var i=n.data.that,t=new TeG.MasterAgent.Add;t.activate()});this.widgetLockUnlockUrl=tegUrlHelper.updateMemberAccountStatus;this.widgetChangePasswordUrl=tegUrlHelper.membersChangeAgentPassword};this.nestedContentLoadConcrete=function(){var n;$("#updateBalanceBlock").find(".js-currency-span").index()!=-1?(n=TeG.Widget.getBalanceBehaivor("MasterAgentUpdateOneCurrency"),n.currency.jElem=$("#updateBalanceBlock").find(".js-currency-span")):(n=TeG.Widget.getBalanceBehaivor("MasterAgentUpdateTwoCurrencies"),n.currency.jElem=$("#updateBalanceBlock").find(".js-currency-select"),n.currencyIdCurrentMember=$("#updateBalanceBlock").find(".js-ho-isocode").val(),n.currencyIdSubordinate=$("#updateBalanceBlock").find(".js-sub-isocode").val(),n.currencyToCurrentMemberRate=tegFinancial.GetCurrencyRate(n.currencyIdCurrentMember,n.currencyIdSubordinate),n.currencyToSubordinateRate=tegFinancial.GetCurrencyRate(n.currencyIdSubordinate,n.currencyIdCurrentMember));n.input.minValue=$("#balance_"+$(".js-updateBalanceInput").attr("id").substring(19)).find("div").html().replace(/([0-9,\s.]*).*/,"$1").replace(/\s|\,/g,"");n.jElemContainer=$("#updateBalanceBlock");n.input.jElem=$(".js-updateBalanceInput");n.input.jElemLabel=$(".js-update-balance");n.input.jElemError=$("#updateBalanceError");n.currency.jElemConvert=$("#updateBalanceTip");n.submit.jElem=$(".js-update-balance-btn");n.submit.action=function(){if(["","-",".","-."].indexOf(this.input.jElem.val())>-1||Number(this.input.jElem.val())==0){new TeG.Validator(this.input.jElem).SetMessage(TeG.Translations.ValidateInsertValidNumericValue).ErrorRenderInHtml2();$("#updateBalanceBlock").find(".js-tip").hide();return}this.memberList.updateBalance.call(this.memberList,n)};n.memberList=this;n.activate();$(".widgetButtonAgents").on("click",{that:this},function(n){var t=n.data.that;t.memberDetailsLoad(function(){t.agentsDetailsLoad.call(t);$("#memberDetailContent").html("");$(".js-detail .tabsBar>button").removeClass("selected");$("#memberDetailsAgentsDetailsTab").addClass("selected")})})};this.memberDetailsLoadConcrete=function(){if($(".js-member-nested-block .widgetButtonAgents").css("display")=="none")$("#memberDetailsAgentsDetailsTab").hide();else if($(".js-member-nested-block .widgetButtonAgents").is(":disabled"))$("#memberDetailsAgentsDetailsTab").attr("disabled","disabled"),$("#memberDetailsAgentsDetailsTab").addClass("disabled");else{$(document).off(kendo.support.click,"#memberDetailsAgentsDetailsTab");$(document).on(kendo.support.click,"#memberDetailsAgentsDetailsTab",{that:this},function(n){$(".js-detail .tabsBar>button").removeClass("selected");$(this).addClass("selected");$("#memberDetailContent").html("");n.data.that.agentsDetailsLoad.call(n.data.that)})}$("#memberDetailsBlock .js-type").html($("#memberDetailsBlock .js-type").attr("data-HO"));$("#memberDetailsBlock .js-back").html($("#memberDetailsBlock .js-back").attr("data-HOBack"))};this.agentsDetailsLoad=function(){tegPopups.showDaisyWheelTotalHover();$.ajax({type:"GET",url:tegUrlHelper.referredMembersList,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{LoginName:$.trim(this.gridBehaivor.getSelectedRowData().LoginName)},dataType:"html",that:this,error:function(n){tegErrorHandler.processError(n,TeG.Translations.PopupError)}}).done(function(n){var t=this.that,r=$(n).find(".k-grid").attr("id"),i;$("#memberDetailContent").html(n);i=$("div#"+r).data("kendoGrid");TeG.Grid.Options.Restore(i);i.dataSource.fetch().then(function(){if(resizeGrid(),t.gridBehaivorAgentsDetails=new TeG.Grid($("#"+getGridNameDetailsAgentsDetail()).data("kendoGrid")),t.gridBehaivorAgentsDetails.addColumnOrderBehaivor.call(t.gridBehaivorAgentsDetails),$("#"+getGridNameDetailsAgentsDetail()).children(".k-grid-header").children(".k-grid-header-wrap").children("table").children("thead").children("tr").children("th:last").children("span").html()=="&nbsp;"&&$("#"+getGridNameDetailsAgentsDetail()).children(".k-grid-header").children(".k-grid-header-wrap").children("table").children("thead").children("tr").children("th:last").html(TeG.Translations.ColumnNameLogin),$("#DivReferredMembersGrid").children("#ReferredMembersGrid").children(".k-grid-header").children(".k-grid-header-wrap").children("table").children("thead").children("tr").children("th:last").html()=="Login"&&$("#DivReferredMembersGrid").children("#ReferredMembersGrid").children(".k-grid-header").children(".k-grid-header-wrap").children("table").children("thead").children("tr").children("th:last").html(TeG.Translations.ColumnNameLogin),i._events.dataBound.push(function(){t.gridBehaivorAgentsDetails.onBound()}),tegPopups.closeTotalHover(),!t.isLLLoginActivate)$(document).on("click","td.l-l-login",{that:this},function(){t.isLLLoginActivate=!0;var n=new TeG.Widget.Button.LoginToAccount,i=this;n.On().addListener("click",function(){this.source.data.LoginName=$(i).attr("data-account")});n.click()})})})}},Add:function(){this.memberType="HeadOffice";this.addPageUrl=tegUrlHelper.addMemberMasterAgentPage;this.init=function(){var n=TeG.Widget.getBalanceBehaivor("MasterAgentAddTwoCurrencies");n.jElemContainer=$("#balance-container");n.input.jElem=$("#AddMemberCasinoCreditBalance");n.input.jElemLabel=$('label[for="AddMemberCasinoCreditBalance"]');n.input.jElemError=$("#add-balance-error");n.currencyIdCurrentMember=$("#add-currency").attr("data-defaultCurrencyId");n.currency.jElem=$("#add-currency");n.currencyIdSubordinate=n.currency.jElem.val();n.currencyToCurrentMemberRate=tegFinancial.GetCurrencyRate(n.currencyIdCurrentMember,n.currencyIdSubordinate);n.currencyToSubordinateRate=tegFinancial.GetCurrencyRate(n.currencyIdSubordinate,n.currencyIdCurrentMember);n.memberCurrencyIso=$("#addMemberIsoCode").html();n.activate()}}};TeG.MasterAgent.List.prototype=TeG.MemberParent.List;TeG.MasterAgent.List.prototype.constructor=TeG.MasterAgent.List;TeG.MasterAgent.Add.prototype=TeG.MemberParent.Add;TeG.MasterAgent.Add.prototype.constructor=TeG.MasterAgent.Add