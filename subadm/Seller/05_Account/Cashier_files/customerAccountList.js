function widgetCustomerAccountListActivate(){tegCustomerAccountList.widgetResetPassword=new TeG.Widget.Button.ResetPassword;$(document).on(kendo.support.click,".nested_block .widgetButtonResetPassword",{that:tegCustomerAccountList.widgetResetPassword},tegCustomerAccountList.widgetResetPassword.Click);tegCustomerAccountList.widgetResetPassword.On().addListener("click",tegCustomerAccountList.WidgetListener.ResetPassword.Click);tegCustomerAccountList.widgetResetPassword.On().addListener("successFalse",tegCustomerAccountList.WidgetListener.ResetPassword.SuccessFalse);tegCustomerAccountList.widgetResetPassword.On().addListener("successFlowStart",tegCustomerAccountList.WidgetListener.ResetPassword.SuccessFlowStart);tegCustomerAccountList.widgetLockUnlockAccount=new TeG.Widget.Button.LockUnlockAccount;$(document).on(kendo.support.click,".nested_block .widgetLockUnlockAccount",tegCustomerAccountList.widgetLockUnlockAccount.Click);tegCustomerAccountList.widgetLockUnlockAccount.On().addListener("successFlowEnd",tegCustomerAccountList.WidgetListener.LockUnlockAccount.SuccessFlowEnd);tegCustomerAccountList.widgetUpdateCustomerProgressiveStatus=new TeG.Widget.Button.UpdateCustomerProgressiveStatus;$(document).on(kendo.support.click,".nested_block .widgetUpdateCustomerProgressiveStatus",tegCustomerAccountList.widgetUpdateCustomerProgressiveStatus.Click);tegCustomerAccountList.widgetUpdateCustomerProgressiveStatus.On().addListenerIfNotExist("successFlowEnd",tegCustomerAccountList.WidgetListener.UpdateCustomerProgressiveStatus.SuccessFlowEnd);tegCustomerAccountList.widgetDeleteAccount=new TeG.Widget.Button.DeleteAccount;$(document).on(kendo.support.click,".nested_block .widgetButtonDeleteAccount",tegCustomerAccountList.widgetDeleteAccount.Click);tegCustomerAccountList.widgetDeleteAccount.On().addListener("click",tegCustomerAccountList.WidgetListener.DeleteAccount.Click);tegCustomerAccountList.widgetDeleteAccount.On().addListener("successFlowEnd",tegCustomerAccountList.WidgetListener.DeleteAccount.SuccessFlowEnd);tegCustomerAccountList.widgetResetLoginAttempts=new TeG.Widget.Button.ResetLoginAttempts;$(document).on(kendo.support.click,".nested_block .widgetButtonResetLoginAttempts",tegCustomerAccountList.widgetResetLoginAttempts.Click)}var TeG=TeG||{};TeG.CustomerAccountList=function(n,t,i){function u(){var i=$("#"+n).data("kendoGrid"),f=[],r,u,e,o;if(i.dataSource.filter()!=null){for(r=i.dataSource.filter().filters.length-1;r>=0;r--)i.dataSource.filter().filters[r].field==t&&i.dataSource.filter().filters.splice(r,1);f=i.dataSource.filter().filters}u=$("#GlobalSearchEdit").val();e=$("#GlobalSearchEdit").attr("default-value");localStorage.setItem(TeG.GlobalVariables.GlobalSearchCacheKey+n,u);u!=""&&u!=e&&(o={field:t,operator:"contains",value:u},f.push(o));i.dataSource.filter(f)}function r(n,t){if(n)if(n.filters)for(var i=0;i<n.filters.length;i++)r(n.filters[i],t);else t[n.field]=!0}var f=this;$("#searchBtn").on("submit",function(){return RefreshGrid(),!1});return $("#GlobalSearchEdit").length>0&&TeG.Utils().searchBehaivor($("#GlobalSearchEdit"),u),{AddGlobalSearchBehaviour:function(){$("#searchBtn").on("submit",function(){return RefreshGrid(),!1});$("#GlobalSearchEdit").length>0&&TeG.Utils().searchBehaivor($("#GlobalSearchEdit"),u)},RefreshGrid:function(){return u()},OnGridSelection:function(){},UpdateCustomerAccountBalances:function(t){for(var i=$("#"+n).data("kendoGrid"),u=t?t:i.dataSource.data(),f,r=0;r<u.length;r++)f=u[r],$.ajax({url:tegUrlHelper.GetCustomerAccountBalance,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({accountNumber:f.AccountNo,force:!1}),dataType:"json"}).done(function(t){var r=document.getElementById("balanceDiv_"+t.accNo),u="",f;if(r!=null){if(t.balance==-1){r.innerHTML="<img src='/Images/balance-ajax-loader.gif' />";return}if(n=="StationsGrid"){f="";f=t.balance==0?"<span style='color: green'>"+t.balanceStr+"<\/span>":"<span style='color: red'>"+t.balanceStr+"<\/span>";typeof TeG.Financial!="undefined"&&typeof TeG.Financial.Rate!="undefined"&&TeG.Financial.Rate==1&&(u=$("#currency").html()==""?r.innerHTML.split("&nbsp;")[1]:$("#currency").html(),f+="&nbsp;"+u);r.innerHTML=f;return}Number(t.balance)>0&&i.dataItem(i.select()).AccountNo==t.accNo&&(i.select().next().find("div#withdrawalDivBlock:hidden").find("input#WithDrawalInput_"+i.dataItem(i.select()).AccountNo).val(t.balance),i.select().next().find("div#withdrawalDivBlock:hidden").find("input#WithDrawalInput_"+i.dataItem(i.select()).AccountNo).removeAttr("disabled"),i.select().next().find("div#withdrawalDivBlock:hidden").show());typeof TeG.Financial!="undefined"&&typeof TeG.Financial.Rate!="undefined"&&TeG.Financial.Rate==1&&($("#currency").html()!=""?t.balanceStr+="&nbsp;"+$("#currency").html():u=r.innerHTML.split("&nbsp;")[1]);r.innerHTML=u?t.balanceStr+"&nbsp;"+u:t.balanceStr}})},OnBoundDelete:function(){var n,t,i;TeG.PlayerList().AddRemovePlayers().Remove().GridInitAdd();TeG.PlayerList().AddRemovePlayers().Remove().CorrectGridHeight();$("#cbCheckAllToDelete").removeAttr("checked");n=$("#RemoveStationsGridContainer").index()!==-1?$("#RemoveStationListGrid").data("kendoGrid"):$("#RemovePlayerListGrid").data("kendoGrid");t=n.dataSource.filter();n.thead.find(".k-header-column-menu").find("span").removeClass("filtering_funnel").addClass("k-icon").addClass("k-i-arrowhead-s");t&&(i={},r(t,i),n.thead.find("th[data-field]").each(function(){var n=$(this),t=i[n.data("field")];t&&n.find(".k-header-column-menu").find("span").removeClass("k-icon").removeClass("k-i-arrowhead-s").addClass("filtering_funnel")}))},StoreGridColumns:function(){setTimeout(function(){var r=TeG.CustomerAccountList(n,t).GetGridConfiguration(n),u=TeG.CustomerAccountList(n,t).GetGridColumns(r),f=r.name;$.ajax({url:tegUrlHelper.StoreGridColumnsOrder,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({gridType:f,columnNames:u,reportParametersHashCode:i})})},50)},ClearGridColumnsOrder:function(){var r=TeG.CustomerAccountList(n,t).GetGridConfiguration(n),u=r.name;$.ajax({url:tegUrlHelper.ClearGridColumnsOrder,async:!1,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({gridType:u,reportParametersHashCode:i})})},GridOnBound:function(){var n,t,i;$("#body-pane-loader").hide();$("#body-pane-content").show();setTimeout(window.splitterResize,100);n=$("#DivRepresentativesGrid").index()!==-1&&$("#DivRepresentativesPasswordsGrid").index()!==-1?$("#RepresentativesPasswordsGrid").data("kendoGrid"):$("#RepresentativesGrid").data("kendoGrid");$("#DivStationsPasswordsGrid").index()!==-1&&(n=$("#StationsPasswordsGrid").data("kendoGrid"));t=null;n.dataSource&&typeof n.dataSource.filter=="function"&&(t=n.dataSource.filter());n.thead&&typeof n.thead.find=="function"&&n.thead.find(".k-header-column-menu").find("span").removeClass("filtering_funnel").addClass("k-icon").addClass("k-i-arrowhead-s");t&&(i={},r(t,i),n.thead.find("th[data-field]").each(function(){var n=$(this),t=i[n.data("field")];t&&n.find(".k-header-column-menu").find("span").removeClass("k-icon").removeClass("k-i-arrowhead-s").addClass("filtering_funnel")}))},GridOnBoundReport:function(){var t,i;$("#"+n).length>0&&$("#"+n).data("kendoGrid").dataSource._view.length>10?$("#collapseBehaivor").is(":visible")&&$("#collapseBehaivor").click():$("#expandBehaivor").is(":visible")&&$("#expandBehaivor").click();setTimeout(window.resizeGrid,100);t=this.dataSource.filter();this.thead.find(".k-header-column-menu").find("span").removeClass("filtering_funnel").addClass("k-icon").addClass("k-i-arrowhead-s");t&&(i={},r(t,i),this.thead.find("th[data-field]").each(function(){var n=$(this),t=i[n.data("field")];t&&n.find(".k-header-column-menu").find("span").removeClass("k-icon").removeClass("k-i-arrowhead-s").addClass("filtering_funnel")}))},GridOnBoundWithRefresh:function(){var i,u,f;n==="RemovePlayerListGrid"?n="PlayersGrid":(n==="RemoveStationListGrid"||n==="StationsPasswordsGrid")&&(n="StationsGrid");setTimeout(TeG.CustomerAccountList(n,t).UpdateCustomerAccountBalances,100);$("#body-pane-loader").css("display","none");$("#body-pane-content").css("display","");resizeGrid();i=$("#DivStationsGrid").index()!==-1?$("#StationsGrid").data("kendoGrid"):$("#PlayersGrid").data("kendoGrid");$(i.table.find("td.RNGMaxPayout")).each(function(){$(this).kendoTooltip({callout:!1,animation:{open:{effects:"fade:in",duration:"100"}},content:function(n){var t="";return n.target.attr("name")==0&&(t+=TeG.Translations.ToolTipPendingProfile+": "),t+n.target.text()}})});u=null;i.dataSource&&typeof i.dataSource.filter=="function"&&(u=i.dataSource.filter());i.thead&&typeof i.thead.find=="function"&&i.thead.find(".k-header-column-menu").find("span").removeClass("filtering_funnel").addClass("k-icon").addClass("k-i-arrowhead-s");u&&(f={},r(u,f),i.thead.find("th[data-field]").each(function(){var n=$(this),t=f[n.data("field")];t&&n.find(".k-header-column-menu").find("span").removeClass("k-icon").removeClass("k-i-arrowhead-s").addClass("filtering_funnel")}));$("td.progressiveStatus").each(function(){$(this).attr("name")!=undefined&&$(this).attr("name")=="true"&&$(this).attr("title",TeG.Translations.ToolTipCustomerProgressiveStatusYes)})},GetGridConfiguration:function(){var t=null;return $.ajax({url:tegUrlHelper.GetGridConfiguration+"?gridName="+n,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",async:!1}).done(function(n){t=n}),t},GetGridColumns:function(t){var i=[],r=t.fields;return $("#"+n).find(".k-header").each(function(){r[$(this).attr("data-field")]&&i.push({ColumnName:$(this).attr("data-field"),IsVisible:$(this).css("display")!="none"})}),i},ChangeReceipt:function(n){n.parent().parent().find(".form_cntr").toggle("easing",function(){var n=$(this).parent().find(".nestedBlockChange");n.hasClass("expand")?n.removeClass("expand").addClass("collapse"):n.removeClass("collapse").addClass("expand")})},OnNestedContentLoad:function(){function e(n){$(n).fadeOut("fast",function(){$(this).fadeIn("fast",function(){e(this)})})}function o(n){if(n=="StationsGrid"){$("#withdrawalBtn_"+t.AccountNo).addClass("loading");var i=tegUrlHelper.fundsOnTableTabDetails;$.ajax({type:"POST",url:i,contentType:"application/json; charset=utf-8",dataType:"html",data:JSON.stringify({accountNumber:t.AccountNo}),error:function(n){tegErrorHandler.processError(n);$("#accountDetailsTabDetails").removeClass("divLoading")},success:function(n,i,r){tegErrorHandler.checkAjaxResponse(r)&&(n=JSON.parse(n),n.ListFunds.length==0?$("#withdrawalBtn_"+t.AccountNo).removeClass("loading"):($("#withdrawalBtn_"+t.AccountNo).attr("onclick","nestedBlockScripts.Withdrawal().ShowFundsOnTablePopUp($(this))"),$("#withdrawalBtn_"+t.AccountNo).removeClass("loading")))}})}}var i=$("#"+n).data("kendoGrid"),t=i.dataItem(i.select()),u,r,f;$(".empty-table-part").width($("td.fake-column").outerWidth());$(String.format("button#updateCustomerProgressiveStatusRef_{0}",t.AccountNo)).find("span.icon_big").hasClass("progressive")?$(i.select()).find(String.format("td#progressiveStatus_{0}",t.AccountNo)).attr({name:"true",title:TeG.Translations.ToolTipCustomerProgressiveStatusYes}):$(String.format("button#updateCustomerProgressiveStatusRef_{0}",t.AccountNo)).find("span.icon_big").hasClass("no-progressive")&&$(i.select()).find(String.format("td#progressiveStatus_{0}",t.AccountNo)).attr({name:"false",title:""});$("#refreshColumns_"+t.AccountNo).children("div").each(function(){$(this).attr("name")!=undefined&&$(i.select()).find("."+$(this).attr("class")).attr({name:$(this).attr("name")});$(this).html()!=""&&$(i.select()).find("."+$(this).attr("class")).html($(this).html())});$(String.format("div#balanceDiv_{0}",t.AccountNo)).css({background:'url("/Images/balance-ajax-loader.gif") no-repeat',"background-position":"right","font-size":"0"});$(String.format("input#WithDrawalInput_{0}",t.AccountNo)).css({background:'url("/Images/balance-ajax-loader.gif") no-repeat',"background-position":"center","font-size":"0"});$(String.format("#withdrawalBtn_{0}",t.AccountNo)).prop("disabled",!0);$("#withdrawalBtn_"+t.AccountNo).addClass("loading");$("input#WithDrawalInput_%accNo%>span".replace("%accNo%",t.AccountNo)).val("");$.ajax({url:tegUrlHelper.GetCustomerAccountBalance,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify({accountNumber:t.AccountNo,force:!0}),dataType:"json"}).error(function(){$(String.format("div#balanceDiv_{0}",t.AccountNo)).css({background:"","background-position":"","font-size":""});$(String.format("input#WithDrawalInput_{0}",t.AccountNo)).css({background:"","background-position":"","font-size":""});$(String.format("#withdrawalBtn_{0}",t.AccountNo)).prop("disabled",!1).removeClass("loading")}).done(function(n){var n=n||{},i;$(String.format("div#balanceDiv_{0}>span",n.accNo)).length==0?(i=$(String.format("div#balanceDiv_{0}",n.accNo)).html(),$(String.format("div#balanceDiv_{0}",n.accNo)).html(String.format("{0}&nbsp;{1}",n.balanceStr,i.split("&nbsp;")[1]||""))):$(String.format("div#balanceDiv_{0}>span",n.accNo)).html(n.balanceStr);$(String.format("input#WithDrawalInput_{0}",n.accNo)).val(tegFinancial.CurrencyFormat(tegFinancial.ConvertToCurrency(n.balance)));$(String.format("input#WithDrawHiddenValue_{0}",n.accNo)).val(n.balanceStr);$(String.format("input#WithDrawalInput_{0}",n.accNo)).nextAll("div.messenger").find("span#withdrawalCredits").html(n.balanceStr);Number(n.balance)<=0?($(String.format("div#balanceDiv_{0}>span",n.accNo)).css("color","green"),$(String.format("input#WithDrawalInput_{0}",n.accNo)).parent().hide()):($(String.format("div#balanceDiv_{0}>span",n.accNo)).css("color","red"),$(String.format("input#WithDrawalInput_{0}",n.accNo)).parent().show());$(String.format("div#balanceDiv_{0}",n.accNo)).css({background:"","background-position":"","font-size":""});$(String.format("input#WithDrawalInput_{0}",n.accNo)).css({background:"","background-position":"","font-size":""});$(String.format("#withdrawalBtn_{0}",t.AccountNo)).prop("disabled",!1);$(String.format("#withdrawalBtn_{0}",t.AccountNo)).removeClass("loading")});Number($("#WithDrawalInput_"+t.AccountNo))>0&&new TeG.Validator($("#WithDrawalInput_"+t.AccountNo)).CurrencyListener(null).isValid&&nestedBlockScripts.Withdrawal().InputKeyUp($("#WithDrawalInput_"+t.AccountNo));$("#WithDrawalInput_"+t.AccountNo).val(tegFinancial.ConvertToCurrency($("#WithDrawHiddenValue_"+t.AccountNo).val()));$("#WithDrawalInput_"+t.AccountNo).val($.trim($("#WithDrawalInput_"+t.AccountNo).val()));u=parseFloat($("#WithDrawalInput_"+t.AccountNo).val());u>0&&($("#withdrawalCreditsInfo").show(),$("#withdrawalCredits").html(tegFinancial.CurrencyFormat(tegFinancial.ConvertToCredits($("#WithDrawalInput_"+t.AccountNo).val()))),o(n));$(".disabled input").attr("disabled","disabled");$(".disabled button").attr("disabled","disabled");r=$("#nestedBlockMainPart").find(".widgetButtonResetLoginAttempts").find(".count");f=t.AccountNo;r.html("<img src='/Images/spinner14x14.gif' alt='preload spinner'>");$.ajax({url:tegUrlHelper.getPlayerLoginAttempts,type:"POST",data:{AccountNumber:f}}).done(function(n){n.LoginAttemptsCount>2?(r.html("<span>"+n.LoginAttemptsCount+"<span>"),r.addClass("red-blink"),e(r.find("span"))):(r.removeClass("red-blink"),r.html(n.LoginAttemptsCount))});$(String.format("button#updateCustomerProgressiveStatusRef_{0}",t.AccountNo)).length>0&&(i.dataItem(i.select()).IsProgressive=$(String.format("button#updateCustomerProgressiveStatusRef_{0}",t.AccountNo)).find("span.icon_big").hasClass("progressive"));$("body").trigger("NestedContentLoaded")},WidgetListener:{ResetPassword:{Click:function(){if($("#receipt").show(),(new TeG.Validator).IsContainerHasDisplayedErrorMessage($("#receipt"))){this.source.isCancel=!0;return}$("#receipt").hide();this.source.data.emailVal=$("#email").is(":checked")?$('input[name="emailValue"]').val():"";this.source.data.smsVal=$("#sms").is(":checked")?$('input[name="smsValue"]').val():""},SuccessFalse:function(){$("#receipt").is(":visible")||$("#change").click();setTimeout(function(){$('#receipt input[name="emailValue"]').focus()},250)},SuccessFlowStart:function(){if(/spanToChange/.test($(".js-resetPasswordTranslate_"+this.source.accountNumber+' input[name="resetPasswordSuccessPopupMessage"]').val())){var t=$(".js-resetPasswordTranslate_"+this.source.accountNumber+' input[name="resetPasswordSuccessPopupMessage"]').val();t=t.replace(/spanToChange/,'<span class="greenText boldText">'+this.source.ajaxData.newPassword+"<\/span>");$(".js-resetPasswordTranslate_"+this.source.accountNumber+' input[name="resetPasswordSuccessPopupMessage"]').val(t)}new TeG.NestedBlock(n).NestedBlockClose()}},LockUnlockAccount:{SuccessFlowEnd:function(){TeG.NestedBlock(n).NestedBlockClose();TeG.NestedBlock(n).NestedBlockOpen()}},UpdateCustomerProgressiveStatus:{SuccessFlowEnd:function(){TeG.NestedBlock(n).NestedBlockClose();TeG.NestedBlock(n).NestedBlockOpen()}},DeleteAccount:{Click:function(){if(parseInt($("#balanceDiv_"+this.source.accountNumber).html().replace(/\<.*?\>/g,"").replace(/(d{0,}\.\d{0,}).*?$/,"$1"))!==0){this.source.isCancel=!0;tegPopups.showTotalHover();var n=new tegPopups.error;n.widget=this.source;n.CloseButtonHandler=function(){this.widget.elem.removeClass("loading");tegPopups.closeTotalHover();n.hide()};n.show(TeG.Translations.NestedBlockErrorDeleteAccount,TeG.Translations.PopupErrorNotEmptyAccountBalanceDeleteMessage)}},SuccessFlowEnd:function(){tegPopups.closeTotalHover();tegPopups.success().hide();customerAccountListManager.RefreshGrid()}}}}};tegCustomerAccountList=TeG.CustomerAccountList()